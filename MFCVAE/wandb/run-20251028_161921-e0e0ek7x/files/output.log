Initialize Shapes dataset and data loaders...
Downloading http://yann.lecun.com/exdb/mnist/train-images-idx3-ubyte.gz
Failed to download (trying next):
HTTP Error 404: Not Found

Downloading https://ossci-datasets.s3.amazonaws.com/mnist/train-images-idx3-ubyte.gz
Downloading https://ossci-datasets.s3.amazonaws.com/mnist/train-images-idx3-ubyte.gz to data/MNIST/raw/train-images-idx3-ubyte.gz
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 9912422/9912422 [00:05<00:00, 1768701.88it/s]
Extracting data/MNIST/raw/train-images-idx3-ubyte.gz to data/MNIST/raw

Downloading http://yann.lecun.com/exdb/mnist/train-labels-idx1-ubyte.gz
Failed to download (trying next):
HTTP Error 404: Not Found

Downloading https://ossci-datasets.s3.amazonaws.com/mnist/train-labels-idx1-ubyte.gz
Downloading https://ossci-datasets.s3.amazonaws.com/mnist/train-labels-idx1-ubyte.gz to data/MNIST/raw/train-labels-idx1-ubyte.gz
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28881/28881 [00:00<00:00, 279968.60it/s]
Extracting data/MNIST/raw/train-labels-idx1-ubyte.gz to data/MNIST/raw

Downloading http://yann.lecun.com/exdb/mnist/t10k-images-idx3-ubyte.gz
Failed to download (trying next):
HTTP Error 404: Not Found

Downloading https://ossci-datasets.s3.amazonaws.com/mnist/t10k-images-idx3-ubyte.gz
Downloading https://ossci-datasets.s3.amazonaws.com/mnist/t10k-images-idx3-ubyte.gz to data/MNIST/raw/t10k-images-idx3-ubyte.gz
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1648877/1648877 [00:01<00:00, 1490117.45it/s]
Extracting data/MNIST/raw/t10k-images-idx3-ubyte.gz to data/MNIST/raw

Downloading http://yann.lecun.com/exdb/mnist/t10k-labels-idx1-ubyte.gz
Failed to download (trying next):
HTTP Error 404: Not Found

Downloading https://ossci-datasets.s3.amazonaws.com/mnist/t10k-labels-idx1-ubyte.gz
Downloading https://ossci-datasets.s3.amazonaws.com/mnist/t10k-labels-idx1-ubyte.gz to data/MNIST/raw/t10k-labels-idx1-ubyte.gz
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4542/4542 [00:00<00:00, 1590194.39it/s]
Extracting data/MNIST/raw/t10k-labels-idx1-ubyte.gz to data/MNIST/raw
Traceback (most recent call last):
  File "train_mnsit.py", line 1131, in <module>
    train(beta_z, beta_c)
  File "train_mnsit.py", line 404, in train
    train_data = MNIST_13Rot(train=True, device=args.device)
  File "/home/wessim/PHD/Clustering(SophIA)/MFCVAE/datasets.py", line 29, in __init__
    rotated_data = torch.stack([TF.rotate(img, 90) for img in data])
  File "/home/wessim/PHD/Clustering(SophIA)/MFCVAE/datasets.py", line 29, in <listcomp>
    rotated_data = torch.stack([TF.rotate(img, 90) for img in data])
  File "/home/wessim/miniconda3/envs/mfcvae/lib/python3.8/site-packages/torchvision/transforms/functional.py", line 1132, in rotate
    return F_t.rotate(img, matrix=matrix, interpolation=interpolation.value, expand=expand, fill=fill)
  File "/home/wessim/miniconda3/envs/mfcvae/lib/python3.8/site-packages/torchvision/transforms/_functional_tensor.py", line 667, in rotate
    return _apply_grid_transform(img, grid, interpolation, fill=fill)
  File "/home/wessim/miniconda3/envs/mfcvae/lib/python3.8/site-packages/torchvision/transforms/_functional_tensor.py", line 558, in _apply_grid_transform
    img = grid_sample(img, grid, mode=mode, padding_mode="zeros", align_corners=False)
  File "/home/wessim/miniconda3/envs/mfcvae/lib/python3.8/site-packages/torch/nn/functional.py", line 4381, in grid_sample
    return torch.grid_sampler(input, grid, mode_enum, padding_mode_enum, align_corners)
RuntimeError: grid_sampler(): expected grid to have size 1 in last dimension, but got grid with sizes [1, 28, 28, 2]
